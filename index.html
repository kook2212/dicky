<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>張偉德 (Dicky Cheung) - 數位名片</title>
    <style>
        /* CSS 樣式：確保在所有裝置上都有良好的視覺效果 */
        :root {
            --primary-color: #007AFF; /* 主色調，類似 iOS 的藍色 */
            --background-color: #f4f4f9;
            --card-background: #ffffff;
            --text-color: #333333;
            --light-text-color: #888888;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--background-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }
        .card {
            background-color: var(--card-background);
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 400px;
            width: 100%;
            box-sizing: border-box;
            text-align: center;
        }
        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            margin-bottom: 20px;
        }
        .name {
            font-size: 26px;
            font-weight: 600;
            color: var(--text-color);
            margin: 0;
        }
        .title {
            font-size: 18px;
            color: var(--light-text-color);
            margin: 5px 0 25px 0;
        }
        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
            text-align: left;
        }
        .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            font-size: 16px;
        }
        .info-item a {
            color: var(--primary-color);
            text-decoration: none;
            word-break: break-all;
        }
        .info-item .icon {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            fill: var(--primary-color);
        }
        .button-container {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px; /* 按鈕之間的間距 */
        }
        .download-btn {
            display: block; /* 讓 <a> 標籤像塊級元素一樣佔滿整行 */
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .download-btn:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }
        /* 針對 CSV 按鈕的特定樣式 */
        .download-btn.csv {
            background-color: #34C759; /* 綠色 */
        }
        .download-btn.csv:hover {
            background-color: #2b9d48;
        }
    </style>
</head>
<body>

    <div class="card">
        <!-- 您可以替換成自己的頭像圖片 URL，或者使用下面的 SVG -->
        <svg class="avatar" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="50" r="50" fill="#e0e0e0"/>
            <path d="M50,65 C35,65 25,75 25,75 L25,85 L75,85 L75,75 C75,75 65,65 50,65 Z" fill="#a0a0a0"/>
            <circle cx="50" cy="45" r="15" fill="#a0a0a0"/>
        </svg>

        <h1 class="name">張偉德 (Dicky Cheung)</h1>
        <p class="title">首席軟體工程師 | ABC Technology Ltd.</p>

        <ul class="info-list">
            <li class="info-item">
                <span class="icon">
                    <svg viewBox="0 0 24 24"><path d="M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"/></svg>
                </span>
                <a href="tel:+85298765432">+852 9876 5432</a>
            </li>
            <li class="info-item">
                <span class="icon">
                    <svg viewBox="0 0 24 24"><path d="M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4M20,8L12,13L4,8V6L12,11L20,6V8Z"/></svg>
                </span>
                <a href="mailto:dicky.cheung@abctech.com">dicky.cheung@abctech.com</a>
            </li>
            <li class="info-item">
                <span class="icon">
                    <svg viewBox="0 0 24 24"><path d="M12,2C15.86,2 19,5.13 19,9C19,14.25 12,22 12,22C12,22 5,14.25 5,9C5,5.13 8.13,2 12,2M12,11.5A2.5,2.5 0 0,0 14.5,9A2.5,2.5 0 0,0 12,6.5A2.5,2.5 0 0,0 9.5,9A2.5,2.5 0 0,0 12,11.5Z"/></svg>
                </span>
                <span>香港中環畢打街1號</span>
            </li>
        </ul>

        <div class="button-container">
            <!-- 
                重要更動：
                1. 使用 <a> 標籤，因為它天生就是用來做連結和下載的。
                2. href="#" 是一個佔位符，JavaScript 會在點擊時動態替換它。
                3. download 屬性告訴瀏覽器這是一個下載連結，並指定預設檔名。
            -->
            <a id="downloadVcfBtn" href="#" class="download-btn" download="">儲存聯絡人 (VCF)</a>
            <a id="downloadCsvBtn" href="#" class="download-btn csv" download="">下載為試算表 (CSV)</a>
        </div>
    </div>

    <script>
        // 將腳本放在 </body> 之前，確保所有 HTML 元素都已載入
        
        // 1. 將聯絡人資料集中管理在一個物件中，方便取用和修改
        const contactInfo = {
            firstName: '偉德',
            lastName: '張',
            fullName: '張偉德 Dicky Cheung',
            org: 'ABC Technology Ltd.',
            title: '首席軟體工程師',
            phone: '+85298765432',
            email: 'dicky.cheung@abctech.com',
            address: '香港中環畢打街1號',
            fileName: 'Dicky_Cheung_Contact' // 用於檔案名稱，避免中文亂碼
        };

        // 2. 準備生成 VCF 檔案內容的函數
        function generateVcfData(data) {
            // VCF (Virtual Contact File) 格式的標準寫法
            const vcfContent = `BEGIN:VCARD
VERSION:3.0
N:${data.lastName};${data.firstName};;;
FN:${data.fullName}
ORG:${data.org}
TITLE:${data.title}
TEL;TYPE=CELL:${data.phone}
EMAIL:${data.email}
ADR;TYPE=WORK:;;${data.address};;;;
END:VCARD`;
            return vcfContent;
        }

        // 3. 準備生成 CSV 檔案內容的函數
        function generateCsvData(data) {
            // CSV (Comma-Separated Values) 格式
            const header = "姓名,公司,職位,電話,電子郵件,地址";
            const row = `"${data.fullName}","${data.org}","${data.title}","${data.phone}","${data.email}","${data.address}"`;
            
            // 加上 BOM (Byte Order Mark) 來提示 Excel 使用 UTF-8 開啟，避免中文亂碼
            const BOM = '\uFEFF'; 
            return BOM + header + '\n' + row;
        }

        // 4. 找到我們的兩個下載按鈕
        const vcfBtn = document.getElementById('downloadVcfBtn');
        const csvBtn = document.getElementById('downloadCsvBtn');

        // 5. 【核心修正】為 VCF 按鈕添加點擊事件監聽器
        vcfBtn.addEventListener('click', function(event) {
            // 設定下載檔名
            this.setAttribute('download', `${contactInfo.fileName}.vcf`);

            // 即時生成 VCF 資料
            const vcfData = generateVcfData(contactInfo);
            
            // 建立一個 Blob 物件 (Binary Large Object)，用來存放我們的檔案內容
            // 'text/vcard' 是 VCF 檔案的標準 MIME 類型
            const blob = new Blob([vcfData], { type: 'text/vcard;charset=utf-8' });
            
            // 建立一個指向這個 Blob 的臨時 URL
            const url = URL.createObjectURL(blob);
            
            // 將按鈕的 href 屬性設置為這個臨時 URL
            // 因為這是在點擊事件中發生的，瀏覽器會立即跟隨這個新連結，從而觸發下載
            this.href = url;
        });

        // 6. 【核心修正】為 CSV 按鈕添加點擊事件監聽器
        csvBtn.addEventListener('click', function(event) {
            // 設定下載檔名
            this.setAttribute('download', `${contactInfo.fileName}.csv`);

            // 即時生成 CSV 資料
            const csvData = generateCsvData(contactInfo);

            // 'text/csv' 是 CSV 檔案的標準 MIME 類型
            const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8' });
            
            // 同樣，建立臨時 URL 並設置 href
            const url = URL.createObjectURL(blob);
            this.href = url;
        });

    </script>

</body>
</html>
